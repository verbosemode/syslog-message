<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Syslog_message (syslog-message.Syslog_message)</title><link rel="stylesheet" href="../../odoc.support/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.2.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">syslog-message</a> &#x00BB; Syslog_message</nav><header class="odoc-preamble"><h1>Module <code><span>Syslog_message</span></code></h1><p>Syslog message parser and unparser</p><p><code>Syslog-message</code> is a module for handling syslog messages, as defined in <a href="https://tools.ietf.org/html/rfc3164">RFC 3164</a>.</p><p>The <code>parse</code> function transforms a string to a syslog message <a href="#type-t"><code>t</code></a>, using a <a href="#type-ctx">context</a> of default parameters. Such a message can be transformed into a string <a href="#val-to_string"><code>to_string</code></a> or pretty printed <code>pp_string</code>, <a href="#val-pp"><code>pp</code></a>.</p><p><em>1.2.0 - <a href="https://github.com/verbosemode/syslog-message">homepage</a></em></p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-facility"><a href="#type-facility" class="anchor"></a><code><span><span class="keyword">type</span> facility</span><span> = </span></code><ol><li id="type-facility.Kernel_Message" class="def variant constructor anchored"><a href="#type-facility.Kernel_Message" class="anchor"></a><code><span>| </span><span><span class="constructor">Kernel_Message</span></span></code></li><li id="type-facility.User_Level_Messages" class="def variant constructor anchored"><a href="#type-facility.User_Level_Messages" class="anchor"></a><code><span>| </span><span><span class="constructor">User_Level_Messages</span></span></code></li><li id="type-facility.Mail_System" class="def variant constructor anchored"><a href="#type-facility.Mail_System" class="anchor"></a><code><span>| </span><span><span class="constructor">Mail_System</span></span></code></li><li id="type-facility.System_Daemons" class="def variant constructor anchored"><a href="#type-facility.System_Daemons" class="anchor"></a><code><span>| </span><span><span class="constructor">System_Daemons</span></span></code></li><li id="type-facility.Security_Authorization_Messages" class="def variant constructor anchored"><a href="#type-facility.Security_Authorization_Messages" class="anchor"></a><code><span>| </span><span><span class="constructor">Security_Authorization_Messages</span></span></code></li><li id="type-facility.Messages_Generated_Internally_By_Syslogd" class="def variant constructor anchored"><a href="#type-facility.Messages_Generated_Internally_By_Syslogd" class="anchor"></a><code><span>| </span><span><span class="constructor">Messages_Generated_Internally_By_Syslogd</span></span></code></li><li id="type-facility.Line_Printer_Subsystem" class="def variant constructor anchored"><a href="#type-facility.Line_Printer_Subsystem" class="anchor"></a><code><span>| </span><span><span class="constructor">Line_Printer_Subsystem</span></span></code></li><li id="type-facility.Network_News_Subsystem" class="def variant constructor anchored"><a href="#type-facility.Network_News_Subsystem" class="anchor"></a><code><span>| </span><span><span class="constructor">Network_News_Subsystem</span></span></code></li><li id="type-facility.UUCP_subsystem" class="def variant constructor anchored"><a href="#type-facility.UUCP_subsystem" class="anchor"></a><code><span>| </span><span><span class="constructor">UUCP_subsystem</span></span></code></li><li id="type-facility.Clock_Daemon" class="def variant constructor anchored"><a href="#type-facility.Clock_Daemon" class="anchor"></a><code><span>| </span><span><span class="constructor">Clock_Daemon</span></span></code></li><li id="type-facility.Security_Authorization_Messages_10" class="def variant constructor anchored"><a href="#type-facility.Security_Authorization_Messages_10" class="anchor"></a><code><span>| </span><span><span class="constructor">Security_Authorization_Messages_10</span></span></code></li><li id="type-facility.Ftp_Daemon" class="def variant constructor anchored"><a href="#type-facility.Ftp_Daemon" class="anchor"></a><code><span>| </span><span><span class="constructor">Ftp_Daemon</span></span></code></li><li id="type-facility.Ntp_Subsystem" class="def variant constructor anchored"><a href="#type-facility.Ntp_Subsystem" class="anchor"></a><code><span>| </span><span><span class="constructor">Ntp_Subsystem</span></span></code></li><li id="type-facility.Log_Audit" class="def variant constructor anchored"><a href="#type-facility.Log_Audit" class="anchor"></a><code><span>| </span><span><span class="constructor">Log_Audit</span></span></code></li><li id="type-facility.Log_Alert" class="def variant constructor anchored"><a href="#type-facility.Log_Alert" class="anchor"></a><code><span>| </span><span><span class="constructor">Log_Alert</span></span></code></li><li id="type-facility.Clock_Daemon_15" class="def variant constructor anchored"><a href="#type-facility.Clock_Daemon_15" class="anchor"></a><code><span>| </span><span><span class="constructor">Clock_Daemon_15</span></span></code></li><li id="type-facility.Local0" class="def variant constructor anchored"><a href="#type-facility.Local0" class="anchor"></a><code><span>| </span><span><span class="constructor">Local0</span></span></code></li><li id="type-facility.Local1" class="def variant constructor anchored"><a href="#type-facility.Local1" class="anchor"></a><code><span>| </span><span><span class="constructor">Local1</span></span></code></li><li id="type-facility.Local2" class="def variant constructor anchored"><a href="#type-facility.Local2" class="anchor"></a><code><span>| </span><span><span class="constructor">Local2</span></span></code></li><li id="type-facility.Local3" class="def variant constructor anchored"><a href="#type-facility.Local3" class="anchor"></a><code><span>| </span><span><span class="constructor">Local3</span></span></code></li><li id="type-facility.Local4" class="def variant constructor anchored"><a href="#type-facility.Local4" class="anchor"></a><code><span>| </span><span><span class="constructor">Local4</span></span></code></li><li id="type-facility.Local5" class="def variant constructor anchored"><a href="#type-facility.Local5" class="anchor"></a><code><span>| </span><span><span class="constructor">Local5</span></span></code></li><li id="type-facility.Local6" class="def variant constructor anchored"><a href="#type-facility.Local6" class="anchor"></a><code><span>| </span><span><span class="constructor">Local6</span></span></code></li><li id="type-facility.Local7" class="def variant constructor anchored"><a href="#type-facility.Local7" class="anchor"></a><code><span>| </span><span><span class="constructor">Local7</span></span></code></li></ol></div><div class="spec-doc"><p>The type for Facilities</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-int_of_facility"><a href="#val-int_of_facility" class="anchor"></a><code><span><span class="keyword">val</span> int_of_facility : <span><a href="#type-facility">facility</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-facility_of_int"><a href="#val-facility_of_int" class="anchor"></a><code><span><span class="keyword">val</span> facility_of_int : <span>int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-facility">facility</a> option</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-string_of_facility"><a href="#val-string_of_facility" class="anchor"></a><code><span><span class="keyword">val</span> string_of_facility : <span><a href="#type-facility">facility</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>string_of_facility f</code> is <code>data</code>, the string representation of <code>f</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_print_facility"><a href="#val-pp_print_facility" class="anchor"></a><code><span><span class="keyword">val</span> pp_print_facility : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-facility">facility</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-severity"><a href="#type-severity" class="anchor"></a><code><span><span class="keyword">type</span> severity</span><span> = </span></code><ol><li id="type-severity.Emergency" class="def variant constructor anchored"><a href="#type-severity.Emergency" class="anchor"></a><code><span>| </span><span><span class="constructor">Emergency</span></span></code></li><li id="type-severity.Alert" class="def variant constructor anchored"><a href="#type-severity.Alert" class="anchor"></a><code><span>| </span><span><span class="constructor">Alert</span></span></code></li><li id="type-severity.Critical" class="def variant constructor anchored"><a href="#type-severity.Critical" class="anchor"></a><code><span>| </span><span><span class="constructor">Critical</span></span></code></li><li id="type-severity.Error" class="def variant constructor anchored"><a href="#type-severity.Error" class="anchor"></a><code><span>| </span><span><span class="constructor">Error</span></span></code></li><li id="type-severity.Warning" class="def variant constructor anchored"><a href="#type-severity.Warning" class="anchor"></a><code><span>| </span><span><span class="constructor">Warning</span></span></code></li><li id="type-severity.Notice" class="def variant constructor anchored"><a href="#type-severity.Notice" class="anchor"></a><code><span>| </span><span><span class="constructor">Notice</span></span></code></li><li id="type-severity.Informational" class="def variant constructor anchored"><a href="#type-severity.Informational" class="anchor"></a><code><span>| </span><span><span class="constructor">Informational</span></span></code></li><li id="type-severity.Debug" class="def variant constructor anchored"><a href="#type-severity.Debug" class="anchor"></a><code><span>| </span><span><span class="constructor">Debug</span></span></code></li></ol></div><div class="spec-doc"><p>The type for Severity levels</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-int_of_severity"><a href="#val-int_of_severity" class="anchor"></a><code><span><span class="keyword">val</span> int_of_severity : <span><a href="#type-severity">severity</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-severity_of_int"><a href="#val-severity_of_int" class="anchor"></a><code><span><span class="keyword">val</span> severity_of_int : <span>int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-severity">severity</a> option</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-string_of_severity"><a href="#val-string_of_severity" class="anchor"></a><code><span><span class="keyword">val</span> string_of_severity : <span><a href="#type-severity">severity</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>string_of_severity s</code> is <code>data</code>, the string representation of <code>s</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_print_severity"><a href="#val-pp_print_severity" class="anchor"></a><code><span><span class="keyword">val</span> pp_print_severity : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-severity">severity</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-ctx"><a href="#type-ctx" class="anchor"></a><code><span><span class="keyword">type</span> ctx</span><span> = </span><span>{</span></code><ol><li id="type-ctx.timestamp" class="def record field anchored"><a href="#type-ctx.timestamp" class="anchor"></a><code><span>timestamp : <span class="xref-unresolved">Ptime</span>.t;</span></code></li><li id="type-ctx.hostname" class="def record field anchored"><a href="#type-ctx.hostname" class="anchor"></a><code><span>hostname : string;</span></code></li><li id="type-ctx.set_hostname" class="def record field anchored"><a href="#type-ctx.set_hostname" class="anchor"></a><code><span>set_hostname : bool;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p><code>ctx</code> provides additional information to the <code>parse</code> function in case one of the sub-parsers fails.</p><ul><li><code>timestamp</code>: A <code>timestamp</code></li><li><code>hostname</code>: Hostname, IPv4 or IPv6 address of the sender. &quot;<i>-</i>&quot; if unknown.</li><li><code>set_hostname</code>: If true, the <code>parse</code> function will skip its hostname sub-parser and use the hostname from <a href="#type-ctx"><code>ctx</code></a> instead.</li></ul><p><code>set_hostname</code> is automatically set by the timestamp sub-parser when it fails, because at this point it is no longer possible to determine the hostname from the input string.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span><span> = </span><span>{</span></code><ol><li id="type-t.facility" class="def record field anchored"><a href="#type-t.facility" class="anchor"></a><code><span>facility : <a href="#type-facility">facility</a>;</span></code></li><li id="type-t.severity" class="def record field anchored"><a href="#type-t.severity" class="anchor"></a><code><span>severity : <a href="#type-severity">severity</a>;</span></code></li><li id="type-t.timestamp" class="def record field anchored"><a href="#type-t.timestamp" class="anchor"></a><code><span>timestamp : <span class="xref-unresolved">Ptime</span>.t;</span></code></li><li id="type-t.hostname" class="def record field anchored"><a href="#type-t.hostname" class="anchor"></a><code><span>hostname : string;</span></code></li><li id="type-t.tag" class="def record field anchored"><a href="#type-t.tag" class="anchor"></a><code><span>tag : string;</span></code></li><li id="type-t.content" class="def record field anchored"><a href="#type-t.content" class="anchor"></a><code><span>content : string;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>The type for Syslog messages</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp"><a href="#val-pp" class="anchor"></a><code><span><span class="keyword">val</span> pp : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>pp ppf t</code> prints the syslog message <code>t</code> on <code>ppf</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-to_string"><a href="#val-to_string" class="anchor"></a><code><span><span class="keyword">val</span> to_string : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>to_string t</code> is <code>str</code>, a pretty printed string of syslog message <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-decode"><a href="#val-decode" class="anchor"></a><code><span><span class="keyword">val</span> decode : <span>ctx:<a href="#type-ctx">ctx</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>(<a href="#type-t">t</a>, <span>[&gt; <span>`Msg of string</span> ]</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p><code>decode ~ctx data</code> is <code>t</code>, either <code>Ok t</code>, a successfully decoded syslog message, or <code>Error e</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-encode"><a href="#val-encode" class="anchor"></a><code><span><span class="keyword">val</span> encode : <span>?len:int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>encode ~len t</code> is <code>data</code>, the encoded syslog message <code>t</code>, truncated to <code>len</code> bytes. If <code>len</code> is 0 the output is not truncated.</p><p><em>Warning:</em> Since version 1.0.0, messages are no longer truncated to 1024 bytes by default.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-encode_local"><a href="#val-encode_local" class="anchor"></a><code><span><span class="keyword">val</span> encode_local : <span>?len:int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>encode_local ~len t</code> behaves as <a href="#val-encode"><code>encode</code></a> except that the message is formatted for sending to the local syslog daemon (e.g. on <code>/dev/log</code>).</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Rfc3164_Timestamp"><a href="#module-Rfc3164_Timestamp" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Rfc3164_Timestamp/index.html">Rfc3164_Timestamp</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>RFC 3164 Timestamps</p></div></div></div></body></html>